% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fqrm.R
\name{fqrm}
\alias{fqrm}
\title{Functional Quantile Regression Model with Spatial Autocorrelation}
\usage{
fqrm(y, x, w, tau, argvals = NULL, nbasis = NULL, method = c("KM", "Ch"))
}
\arguments{
\item{y}{Numeric vector of length \code{n}. Response variable.}

\item{x}{Numeric matrix of size \code{n x p}. Functional predictor observed on a common grid.}

\item{w}{Numeric matrix of size \code{n x n}. Spatial weight matrix.}

\item{tau}{Numeric. Quantile level to estimate (between 0 and 1).}

\item{argvals}{Numeric vector of length \code{p}. Grid of argument values for the functional predictor. If \code{NULL}, defaults to a regular grid on \link{0, 1}.}

\item{nbasis}{Integer. Number of basis functions to use in FPCA. If \code{NULL}, defaults to \code{min(10, p / 4)}.}

\item{method}{Character string. Estimation method to use. One of \code{"KM"} (Kim et al.) or \code{"Ch"} (Chernozhukov et al.).}
}
\value{
A list containing:
\describe{
\item{b}{Estimated coefficient vector in FPCA space.}
\item{b0}{Estimated intercept.}
\item{bhat}{Estimated coefficient function in the original function space.}
\item{rho}{Estimated spatial autoregressive parameter.}
\item{fitted.values}{Fitted values from the model.}
\item{residuals}{Residuals from the model.}
\item{tau}{Quantile level used.}
\item{fpca}{Output from \code{getPCA}, including FPCA scores and basis functions.}
}
}
\description{
Fits a spatial scalar-on-function quantile regression model using either the Kim and Muller (2004)
or Chernozhukov and Hansen (2006) method.
}
\examples{
\dontrun{
sim_data <- dgp(n = 250, rho=0.5)
y <- sim_data$y
x <- sim_data$x
w <- sim_data$w
fit_kim <- fqrm(y=y, x=x, w=w, tau=tau, method = "KM")
fit_ch <- fqrm(y=y, x=x, w=w, tau=tau, method = "Ch")
}

}
